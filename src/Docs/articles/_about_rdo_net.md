[!include[Welcome to RDO.Net](_rdo_net_summary.md)]

[!include[RDO.Net License](_rdo_net_license.md)]

## Why RDO.Net

Enterprise application, typically backed by a relational database, has decades of history. Today's enterprise applications are unnecessarily complex and heavyweight, due to the following technical constraints:

[!include[Enterprise Application Problems](_enterprise_application_problems.md)]

The above challenges impose great burdens for developing and further changing an enterprise application. Many frameworks are trying to solve these problems however they are all far from ideal. RDO.Net is the only solution to these problems in an integral, not an after-thought way (strongly recommended reading through):

* <xref:enterprise_application_the_right_way>
* <xref:orm_data_access_the_right_way>
* <xref:data_presentation_the_right_way>

In the end, your application follows your business in a no-more-no-less basis - it adapts to your business, not vice versa:

* Your application is 100% strongly typed from database to GUI, all in clean C#/VB.Net code. Refactoring or changing your code is much easier than ever before.
* Your data access is best balanced for both programmability and performance. Rich set of data objects such as `Model`, `Db`, `DbTable`, `DbQuery` and `DataSet` are provided, no more [object-relational impedance mismatch](https://en.wikipedia.org/wiki/Object-relational_impedance_mismatch).
* Data access testing is a first class citizen which can be performed easily. Data is the core of your application, now you can build much more robust data access layer.
* A one-for-all, fully customizable data presenter is provided to handle presentation logic including layout, data binding and data validation, all consumed in clean C#/VB.Net code (no XAML needed). You don't need complex controls such as `ListBox`, `TreeView`, `DataGrid` any more. You UI code is greatly simplified because you can reuse all the presentation logic.
* And much more with a lightweight runtime - you only need to add several dlls into your application, size ranged from tens to several hundereds KBs.

## A Taste of RDO.Net

A fully featured sample application, [AdventureWorksLT](https://github.com/DevZest/AdventureWorksLT), together with others, is provided to demonstrate the use of RDO.Net:

![image](/images/samples_adventureworkslt.wpfapp.jpg)

### The Model

# [C#](#tab/cs)

[!code-csharp[SalesOrderDetail](../../../samples/AdventureWorksLT.SqlServer/AdventureWorksLT/SalesOrderDetail.cs)]

# [VB.Net](#tab/vb)

[!code-vb[SalesOrderDetail](../../../samples.vb/AdventureWorksLT.SqlServer/AdventureWorksLT/SalesOrderDetail.vb)]

***

The code of model can be manipulated in Model Visualizer tool window in Visual Studio:

![image](/images/SalesOrderDetailModelVisualizer.jpg)

### The Database

# [C#](#tab/cs)

[!code-csharp[Db](../../../samples/AdventureWorksLT.SqlServer/AdventureWorksLT/Db.cs)]

# [VB.Net](#tab/vb)

[!code-vb[Db](../../../samples.vb/AdventureWorksLT.SqlServer/AdventureWorksLT/Db.vb)]

***

The code of database can be manipulated via Db Visualizer tool window in Visual Studio:

![image](/images/AdventureWorksLTDbVisualizer.jpg)

### Data Access (CRUD)

# [C#](#tab/cs)

[!code-csharp[DbApi](../../../samples/AdventureWorksLT.SqlServer/AdventureWorksLT/Db.Api.cs#SalesOrderCRUD)]

# [VB.Net](#tab/vb)

[!code-vb[DbApi](../../../samples.vb/AdventureWorksLT.SqlServer/AdventureWorksLT/Db.Api.SalesOrder.vb)]

***

### Data Presentation

# [C#](#tab/cs)

[!code-csharp[DetailPresenter](../../../samples/AdventureWorksLT.WpfApp/SalesOrderWindow.DetailPresenter.cs)]

# [VB.Net](#tab/vb)

[!code-vb[DetailPresenter](../../../samples.vb/AdventureWorksLT.WpfApp/SalesOrderWindow.DetailPresenter.vb)]

***

This will produce the following data grid UI, with foreign key lookup and paste append from clipboard:

![image](/images/SalesOrderDetailUI.jpg)

### Mock Database for Testing

# [C#](#tab/cs)

```csharp
public sealed class MockSalesOrder : DbMock<Db>
{
    public static Task<Db> CreateAsync(Db db, IProgress<DbInitProgress> progress = null, CancellationToken ct = default(CancellationToken))
    {
        return new MockSalesOrder().MockAsync(db, progress, ct);
    }

    // This method is generated by a tool
    private static DataSet<SalesOrderHeader> Headers()
    {
        DataSet<SalesOrderHeader> result = DataSet<SalesOrderHeader>.Create().AddRows(4);
        SalesOrderHeader _ = result._;
        _.SuspendIdentity();
        _.SalesOrderID[0] = 1;
        _.SalesOrderID[1] = 2;
        ...
        _.ResumeIdentity();
        return result;
    }

    // This method is generated by a tool
    private static DataSet<SalesOrderDetail> Details()
    {
        DataSet<SalesOrderDetail> result = DataSet<SalesOrderDetail>.Create().AddRows(32);
        SalesOrderDetail _ = result._;
        _.SuspendIdentity();
        ...
        _.SalesOrderDetailID[0] = 1;
        _.SalesOrderDetailID[1] = 2;
        ...
        _.ResumeIdentity();
        return result;
    }

    protected override void Initialize()
    {
        // The order of mocking table does not matter, the dependencies will be sorted out automatically.
        Mock(Db.SalesOrderDetail, Details);
        Mock(Db.SalesOrderHeader, Headers);
    }
}
```

# [VB.Net](#tab/vb)

```vb
Public Class MockSalesOrder
    Inherits DbMock(Of Db)

    Public Shared Function CreateAsync(db As Db, Optional progress As IProgress(Of DbInitProgress) = Nothing, Optional ct As CancellationToken = Nothing) As Task(Of Db)
        Return New MockSalesOrder().MockAsync(db, progress, ct)
    End Function

    ' This method is generated by a tool
    Private Shared Function Headers() As DataSet(Of SalesOrderHeader)
        Dim result As DataSet(Of SalesOrderHeader) = DataSet(Of SalesOrderHeader).Create().AddRows(4)
        Dim x As SalesOrderHeader = result.Entity
        x.SuspendIdentity()
        x.SalesOrderID(0) = 1
        x.SalesOrderID(1) = 2
        ...
        x.ResumeIdentity()
        Return result
    End Function

    ' This method is generated by a tool
    Private Shared Function Details() As DataSet(Of SalesOrderDetail)
        Dim result As DataSet(Of SalesOrderDetail) = DataSet(Of SalesOrderDetail).Create().AddRows(32)
        Dim x As SalesOrderDetail = result.Entity
        x.SuspendIdentity()
        ...
        x.SalesOrderDetailID(0) = 1
        x.SalesOrderDetailID(1) = 2
        x.ResumeIdentity()
        ...
        Return result
    End Function

    Protected Overrides Sub Initialize()
        Mock(Db.SalesOrderHeader, Function() Headers())
        Mock(Db.SalesOrderDetail, Function() Details())
    End Sub
End Class
```

***

Testing data code is generated from database:

![image](/images/SalesOrderDetailMockDb.jpg)

## Getting Started

It's highly recommended to start with our [step by step tutorial](xref:tutorial_get_started).
